SELECT
    t.name  AS table_name,
    i.name  AS index_name,
    i.type_desc,
    ic.key_ordinal,
    ic.is_included_column
FROM sys.tables t
JOIN sys.columns c
    ON c.object_id = t.object_id
JOIN sys.index_columns ic
    ON ic.object_id = c.object_id
   AND ic.column_id = c.column_id
JOIN sys.indexes i
    ON i.object_id = ic.object_id
   AND i.index_id  = ic.index_id
WHERE t.name = ''
  AND c.name = ''
ORDER BY i.name, ic.key_ordinal;

SELECT
    s.name AS stats_name,
    t.name AS table_name
FROM sys.stats s
JOIN sys.stats_columns sc
    ON sc.object_id = s.object_id
   AND sc.stats_id  = s.stats_id
JOIN sys.columns c
    ON c.object_id = sc.object_id
   AND c.column_id = sc.column_id
JOIN sys.tables t
    ON t.object_id = s.object_id
WHERE t.name = ''
  AND c.name = '';


  SELECT
    OBJECT_SCHEMA_NAME(d.referencing_id) AS referencing_schema,
    OBJECT_NAME(d.referencing_id)        AS referencing_object,
    o.type_desc,
    d.referenced_entity_name,
    d.referenced_class_desc
FROM sys.sql_expression_dependencies d
JOIN sys.objects o
  ON o.object_id = d.referencing_id
WHERE d.referenced_id = OBJECT_ID('')
ORDER BY o.type_desc, referencing_schema, referencing_object;

SELECT
    OBJECT_SCHEMA_NAME(m.object_id) AS schema_name,
    OBJECT_NAME(m.object_id)        AS object_name,
    o.type_desc
FROM sys.sql_modules m
JOIN sys.objects o
  ON o.object_id = m.object_id
WHERE m.definition LIKE '%%';

DECLARE @obj int = OBJECT_ID('');
DECLARE @col int =
(
    SELECT column_id
    FROM sys.columns
    WHERE object_id = @obj
      AND name = ''
);

SELECT
    OBJECT_SCHEMA_NAME(d.referencing_id) AS referencing_schema,
    OBJECT_NAME(d.referencing_id)        AS referencing_object,
    o.type_desc
FROM sys.sql_expression_dependencies d
JOIN sys.objects o
  ON o.object_id = d.referencing_id
WHERE d.referenced_id = @obj
  AND d.referenced_minor_id = @col
ORDER BY o.type_desc, referencing_schema, referencing_object;
