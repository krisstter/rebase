$serviceName = "YourServiceName"

$svc = Get-CimInstance -ClassName Win32_Service -Filter "Name='$serviceName'"
if ($svc -and $svc.ProcessId -ne 0) {
    $pid = $svc.ProcessId

    $proc = Get-Process -Id $pid -ErrorAction SilentlyContinue

    $procInfo = Get-CimInstance Win32_Process -Filter "ProcessId = $pid"

    if ($proc -and $procInfo) {
        [PSCustomObject]@{
            ProcessId        = $pid
            Name             = $proc.ProcessName
            CPUTimeSeconds   = [math]::Round($proc.CPU, 2)
            MemoryMB         = [math]::Round($proc.WorkingSet64 / 1MB, 2)
            PrivateMemoryMB  = [math]::Round($proc.PrivateMemorySize64 / 1MB, 2)
            StartTime        = $procInfo.CreationDate.ToLocalTime()
        }
    } else {
        Write-Host "Process info not found (might require elevation)."
    }
} else {
    Write-Host "Service not found or not running."
}
